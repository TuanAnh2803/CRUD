<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Quản lý Bài viết</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .post { border: 1px solid #ddd; padding: 15px; margin: 10px 0; }
        button { margin-right: 10px; }
        textarea { width: 100%; height: 100px; }
    </style>
</head>
<body>
    <h1>Quản lý Bài viết</h1>
    
    <div>
        <h2>Tạo bài viết mới</h2>
        <input type="text" id="title" placeholder="Tiêu đề"><br><br>
        <textarea id="content" placeholder="Nội dung"></textarea><br>
        <button onclick="createPost()">Tạo bài viết</button>
    </div>

    <div id="posts-container">
        <h2>Danh sách bài viết</h2>
        <!-- Bài viết sẽ hiển thị ở đây -->
    </div>

    <script>
        // Tải danh sách bài viết khi trang load
        window.onload = loadPosts;

        async function loadPosts() {
            try {
                const response = await fetch('http://localhost:3000/api/posts');
                const posts = await response.json();
                
                let html = '';
                posts.forEach(post => {
                    html += `
                        <div class="post">
                            <h3>${post.title}</h3>
                            <p>${post.content}</p>
                            <button onclick="editPost('${post._id}')">Sửa</button>
                            <button onclick="deletePost('${post._id}')">Xóa</button>
                        </div>
                    `;
                });
                
                document.getElementById('posts-container').innerHTML = html;
            } catch (error) {
                console.error('Lỗi khi tải bài viết:', error);
            }
        }

        async function createPost() {
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            
            try {
                const response = await fetch('http://localhost:3000/api/posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ title, content }),
                });

                if (response.ok) {
                    loadPosts(); // Tải lại danh sách
                    // Xóa nội dung form
                    document.getElementById('title').value = '';
                    document.getElementById('content').value = '';
                }
            } catch (error) {
                console.error('Lỗi khi tạo bài viết:', error);
            }
        }
    </script>
</body>
</html>